@model IEnumerable<FrontendMvc.Models.Recipes.RecipeViewModel>

@{
    ViewData["Title"] = "Tarifler";
    var categories = ViewBag.Categories as List<FrontendMvc.Models.Recipes.CategoryViewModel> ?? new();
}

<div class="row gap-20">
    <!-- Başlık ve Filtreler -->
    <div class="col-12">
        <div class="bd bgc-white p-20">
            <div class="layers">
                <div class="layer w-100 mB-20">
                    <div class="peers fxw-nw ai-c">
                        <div class="peer peer-greed">
                            <h4 class="lh-1 mB-0">Tarifler</h4>
                        </div>
                        @if (User.Identity?.IsAuthenticated == true)
                        {
                            <div class="peer">
                                <a asp-controller="Recipes" asp-action="Create" class="btn btn-primary" style="color: white;">
                                    <i class="ti-plus"></i> Yeni Tarif Ekle
                                </a>
                            </div>
                        }
                    </div>
                </div>
                
                <!-- Kategori Filtreleri -->
                @if (categories.Any())
                {
                    <div class="layer w-100 mB-15">
                        <div class="peers fxw-nw gap-10">
                            <a asp-controller="Recipes" asp-action="Index" 
                               class="btn @(ViewBag.CategoryId == null ? "btn-primary" : "btn-outline-primary")">
                                Tümü
                            </a>
                            @foreach (var category in categories)
                            {
                                <a asp-controller="Recipes" asp-action="Index" asp-route-categoryId="@category.Id" 
                                   class="btn @(ViewBag.CategoryId == category.Id ? "btn-primary" : "btn-outline-primary")">
                                    @if (!string.IsNullOrEmpty(category.Icon))
                                    {
                                        <i class="@category.Icon"></i>
                                    }
                                    @category.Name
                                </a>
                            }
                        </div>
                    </div>
                }
                
                <!-- Arama ve Sıralama -->
                <div class="layer w-100">
                    <form asp-controller="Recipes" asp-action="Index" method="get" id="searchForm">
                        @if (ViewBag.CategoryId != null)
                        {
                            <input type="hidden" name="categoryId" value="@ViewBag.CategoryId">
                        }
                        <input type="hidden" name="searchType" id="searchType" value="all" />
                        <div class="d-flex" style="gap: 8px; position: relative;">
                            <div class="search-input-wrapper" style="flex: 1; position: relative;">
                                <i class="ti-search" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #999; font-size: 18px; pointer-events: none;"></i>
                                <input type="text" name="search" id="searchInput" class="form-control" placeholder="Tarif adı veya malzeme ara..." value="@ViewBag.SearchTerm" style="padding-left: 45px; padding-right: 120px;">
                                <div class="search-type-dropdown" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%);">
                                    <button type="button" class="btn btn-link btn-sm search-type-btn" id="searchTypeBtn" style="color: #666; padding: 4px 8px; font-size: 12px; border-left: 1px solid #ddd; padding-left: 12px;">
                                        <i class="ti-angle-down mR-5"></i>
                                        <span id="searchTypeText">Tümü</span>
                                    </button>
                                    <div class="search-type-menu" id="searchTypeMenu" style="display: none; position: absolute; top: 100%; right: 0; background: white; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 1000; margin-top: 5px; min-width: 150px;">
                                        <a href="#" class="search-type-option" data-type="all" style="display: block; padding: 10px 15px; color: #333; text-decoration: none; border-bottom: 1px solid #f0f0f0;">
                                            <i class="ti-layout-grid2 mR-8"></i> Tümü
                                        </a>
                                        <a href="#" class="search-type-option" data-type="title" style="display: block; padding: 10px 15px; color: #333; text-decoration: none; border-bottom: 1px solid #f0f0f0;">
                                            <i class="ti-bookmark mR-8"></i> Tarif Adı
                                        </a>
                                        <a href="#" class="search-type-option" data-type="ingredient" style="display: block; padding: 10px 15px; color: #333; text-decoration: none;">
                                            <i class="ti-shopping-cart mR-8"></i> Malzeme
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary" style="color: white; white-space: nowrap; padding: 8px 20px;">
                                <i class="ti-search mR-5"></i> Ara
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Sıralama Seçenekleri -->
                <div class="layer w-100 mT-15">
                    <div class="peers fxw-nw ai-c gap-10">
                        <span class="fsz-sm c-grey-600" style="line-height: 32px; white-space: nowrap;">
                            <i class="ti-exchange-vertical mR-5"></i> Sırala:
                        </span>
                        <div class="sort-dropdown" style="position: relative;">
                            <button type="button" class="btn btn-outline-secondary btn-sm sort-dropdown-btn" id="sortDropdownBtn" style="min-width: 180px; text-align: left; display: flex; align-items: center; justify-content: space-between;">
                                <span id="sortDropdownText">
                                    @if (ViewBag.SortBy == "rating")
                                    {
                                        <text><i class="ti-star mR-5"></i> En Yüksek Puan</text>
                                    }
                                    else if (ViewBag.SortBy == "likes")
                                    {
                                        <text><i class="ti-heart mR-5"></i> En Çok Beğenilen</text>
                                    }
                                    else
                                    {
                                        <text><i class="ti-layout-grid2 mR-5"></i> Varsayılan</text>
                                    }
                                </span>
                                <i class="ti-angle-down mL-5" style="font-size: 12px;"></i>
                            </button>
                            <div class="sort-dropdown-menu" id="sortDropdownMenu" style="display: none; position: absolute; top: 100%; left: 0; background: white; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 1000; margin-top: 5px; min-width: 180px; overflow: hidden;">
                                <a href="@Url.Action("Index", "Recipes", new { categoryId = ViewBag.CategoryId, search = ViewBag.SearchTerm, sortBy = (string)null })" 
                                   class="sort-option @(ViewBag.SortBy == null || ViewBag.SortBy == "default" ? "active" : "")" 
                                   style="display: flex; align-items: center; padding: 10px 15px; color: #333; text-decoration: none; border-bottom: 1px solid #f0f0f0;">
                                    <i class="ti-layout-grid2 mR-8" style="width: 20px; text-align: center;"></i>
                                    <span>Varsayılan</span>
                                    @if (ViewBag.SortBy == null || ViewBag.SortBy == "default")
                                    {
                                        <i class="ti-check mL-auto" style="color: #007bff;"></i>
                                    }
                                </a>
                                <a href="@Url.Action("Index", "Recipes", new { categoryId = ViewBag.CategoryId, search = ViewBag.SearchTerm, sortBy = "rating" })" 
                                   class="sort-option @(ViewBag.SortBy == "rating" ? "active" : "")" 
                                   style="display: flex; align-items: center; padding: 10px 15px; color: #333; text-decoration: none; border-bottom: 1px solid #f0f0f0;">
                                    <i class="ti-star mR-8" style="width: 20px; text-align: center;"></i>
                                    <span>En Yüksek Puan</span>
                                    @if (ViewBag.SortBy == "rating")
                                    {
                                        <i class="ti-check mL-auto" style="color: #007bff;"></i>
                                    }
                                </a>
                                <a href="@Url.Action("Index", "Recipes", new { categoryId = ViewBag.CategoryId, search = ViewBag.SearchTerm, sortBy = "likes" })" 
                                   class="sort-option @(ViewBag.SortBy == "likes" ? "active" : "")" 
                                   style="display: flex; align-items: center; padding: 10px 15px; color: #333; text-decoration: none;">
                                    <i class="ti-heart mR-8" style="width: 20px; text-align: center;"></i>
                                    <span>En Çok Beğenilen</span>
                                    @if (ViewBag.SortBy == "likes")
                                    {
                                        <i class="ti-check mL-auto" style="color: #007bff;"></i>
                                    }
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tarifler Listesi -->
    @if (!Model.Any())
    {
        <div class="col-12">
            <div class="bd bgc-white p-30 ta-c">
                <h5 class="c-grey-600">Tarif bulunamadı</h5>
                <p class="c-grey-500 mT-10">Arama kriterlerinizi değiştirerek tekrar deneyin.</p>
                <a asp-controller="Recipes" asp-action="Create" class="btn btn-primary mT-20" style="color: white;">
                    <i class="ti-plus"></i> İlk Tarifi Ekle
                </a>
            </div>
        </div>
    }
    else
    {
        @foreach (var recipe in Model)
        {
            <div class="col-md-4 col-lg-4 mb-3">
                <div class="recipe-card-container" data-recipe-id="@recipe.Id">
                    <a asp-controller="Recipes" asp-action="Details" asp-route-id="@recipe.Id" class="recipe-card-link" style="text-decoration: none; display: block;">
                        <div class="bd bgc-white bdrs-3 ov-h recipe-card" style="transition: all 0.3s ease; cursor: pointer; position: relative;">
                            @{
                                // Çoklu fotoğraf desteği: Önce Images listesinden ana fotoğrafı al, yoksa ImageUrl'i kullan
                                var displayImageUrl = recipe.Images?.FirstOrDefault(img => img.IsPrimary)?.ImageUrl 
                                                       ?? recipe.Images?.FirstOrDefault()?.ImageUrl 
                                                       ?? recipe.ImageUrl;
                                var isNew = (DateTime.UtcNow - recipe.CreatedAt).TotalDays < 7;
                                var isPopular = recipe.ViewCount > 100 || recipe.LikeCount > 10;
                            }
                            
                            <!-- Badge'ler -->
                            <div class="recipe-badges" style="position: absolute; top: 10px; left: 10px; z-index: 10; display: flex; flex-direction: column; gap: 5px;">
                                @if (recipe.IsFeatured)
                                {
                                    <span class="badge bg-warning" style="font-size: 11px; padding: 4px 8px;">
                                        <i class="ti-star"></i> Öne Çıkan
                                    </span>
                                }
                                @if (isNew)
                                {
                                    <span class="badge bg-success" style="font-size: 11px; padding: 4px 8px;">
                                        <i class="ti-new"></i> Yeni
                                    </span>
                                }
                                @if (isPopular)
                                {
                                    <span class="badge bg-danger" style="font-size: 11px; padding: 4px 8px;">
                                        <i class="ti-fire"></i> Popüler
                                    </span>
                                }
                            </div>
                            
                            @if (!string.IsNullOrEmpty(displayImageUrl))
                            {
                                <div class="recipe-card-image-wrapper" style="position: relative; overflow: hidden;">
                                    <img src="@displayImageUrl" alt="@recipe.Title" class="w-100" style="height: 200px; object-fit: cover; transition: transform 0.3s ease;" loading="lazy" decoding="async">
                                    <div class="recipe-card-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to top, rgba(0,0,0,0.7), transparent); opacity: 0; transition: opacity 0.3s ease; display: flex; align-items: flex-end; padding: 15px;">
                                        <div class="w-100">
                                            <span class="c-white fw-600 d-block mB-5" style="font-size: 14px;">
                                                <i class="ti-eye mR-5"></i> Detayları Gör
                                            </span>
                                            <!-- Hızlı İstatistikler -->
                                            <div class="peers fxw-nw ai-c gap-10 mT-5" style="font-size: 12px;">
                                                <span class="c-white"><i class="ti-eye mR-3"></i>@recipe.ViewCount</span>
                                                @if (recipe.LikeCount > 0)
                                                {
                                                    <span class="c-white"><i class="ti-heart mR-3"></i>@recipe.LikeCount</span>
                                                }
                                                @if (recipe.AverageRating.HasValue)
                                                {
                                                    <span class="c-white"><i class="ti-star mR-3"></i>@recipe.AverageRating.Value.ToString("F1")</span>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            else
                            {
                                <div class="w-100 bgc-grey-200" style="height: 200px; display: flex; align-items: center; justify-content: center; position: relative;">
                                    <i class="ti-image fsz-xxl c-grey-400"></i>
                                    <div class="recipe-card-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); opacity: 0; transition: opacity 0.3s ease; display: flex; align-items: center; justify-content: center;">
                                        <span class="c-white fw-600">
                                            <i class="ti-eye mR-5"></i> Detayları Gör
                                        </span>
                                    </div>
                                </div>
                            }
                            <div class="p-20">
                                <h6 class="mB-10 c-grey-800" style="transition: color 0.3s ease; min-height: 48px; line-height: 1.4;">
                                    @recipe.Title
                                </h6>
                                <p class="fsz-sm c-grey-600 mB-15" style="min-height: 40px; line-height: 1.4;">
                                    @(recipe.Description.Length > 100 ? recipe.Description.Substring(0, 100) + "..." : recipe.Description)
                                </p>
                                
                                <!-- Yazar Bilgisi -->
                                @if (recipe.Author != null)
                                {
                                    <div class="d-flex ai-c gap-5 mB-10" style="font-size: 12px;">
                                        @if (!string.IsNullOrEmpty(recipe.Author.ProfileImageUrl))
                                        {
                                            <img src="@recipe.Author.ProfileImageUrl" alt="@recipe.Author.DisplayName" 
                                                 class="bdrs-50" style="width: 20px; height: 20px; object-fit: cover;" />
                                        }
                                        <span class="c-grey-600">
                                            <i class="ti-pencil mR-3"></i>@recipe.Author.DisplayName
                                        </span>
                                    </div>
                                }
                                
                                <div class="peers fxw-nw ai-c fsz-sm c-grey-600 mB-10">
                                    <div class="peer mR-15">
                                        <i class="ti-time"></i> @recipe.CookingTimeMinutes dk
                                    </div>
                                    <div class="peer mR-15">
                                        <i class="ti-user"></i> @recipe.Servings kişilik
                                    </div>
                                    @if (recipe.Category != null)
                                    {
                                        <div class="peer">
                                            <span class="category-badge" data-category-id="@recipe.Category.Id" style="font-size: 10px; padding: 2px 6px;">
                                                <i class="@recipe.Category.Icon"></i> @recipe.Category.Name
                                            </span>
                                        </div>
                                    }
                                </div>
                                <div class="peers fxw-nw ai-c mT-10 gap-10">
                                    @if (recipe.AverageRating.HasValue)
                                    {
                                        <div class="peer">
                                            <div class="peers fxw-nw ai-c">
                                                <div class="peer" style="display: inline-flex; align-items: center; gap: 2px;">
                                                    @{
                                                        double visualRating = recipe.AverageRating.Value * 2; // 1-5 -> 2-10
                                                    }
                                                    @for (int i = 0; i < 5; i++)
                                                    {
                                                        int starValue = (i + 1) * 2; // 2, 4, 6, 8, 10
                                                        int starStart = i * 2; // 0, 2, 4, 6, 8
                                                        
                                                        if (visualRating >= starValue)
                                                        {
                                                            <i class="ti-star c-yellow-500" style="font-size: 12px;"></i>
                                                        }
                                                        else if (visualRating > starStart && visualRating < starValue)
                                                        {
                                                            double fractionalPart = (visualRating - starStart) / (starValue - starStart);
                                                            double fillPercentage = fractionalPart * 100;
                                                            <div style="position: relative; display: inline-block; width: 12px; height: 12px; line-height: 1;">
                                                                <i class="ti-star c-grey-300" style="font-size: 12px; position: absolute; left: 0; top: 0; z-index: 1;"></i>
                                                                <div style="position: absolute; left: 0; top: 0; width: @(fillPercentage.ToString("F1", System.Globalization.CultureInfo.InvariantCulture))%; height: 12px; overflow: hidden; z-index: 2;">
                                                                    <i class="ti-star c-yellow-500" style="font-size: 12px; position: absolute; left: 0; top: 0; width: 12px; height: 12px; display: block;"></i>
                                                                </div>
                                                            </div>
                                                        }
                                                        else
                                                        {
                                                            <i class="ti-star c-grey-300" style="font-size: 12px;"></i>
                                                        }
                                                    }
                                                </div>
                                                <div class="peer mL-5 fsz-sm c-grey-600">
                                                    <span class="fw-600">@recipe.AverageRating.Value.ToString("F1")</span>
                                                    @if (recipe.RatingCount > 0)
                                                    {
                                                        <span class="c-grey-500">(@recipe.RatingCount)</span>
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    }
                                    @if (recipe.LikeCount > 0)
                                    {
                                        <div class="peer">
                                            <i class="ti-heart c-red-500"></i>
                                            <span class="fsz-sm c-grey-600 mL-3">@recipe.LikeCount</span>
                                        </div>
                                    }
                                </div>
                            </div>
                            
                            <!-- Hızlı Aksiyonlar (Hover'da görünür) -->
                            <div class="recipe-quick-actions" style="position: absolute; top: 10px; right: 10px; z-index: 10; opacity: 0; transition: opacity 0.3s ease;">
                                @if (User.Identity?.IsAuthenticated == true)
                                {
                                    <button type="button" class="btn btn-sm btn-light recipe-quick-like" data-recipe-id="@recipe.Id" 
                                            style="width: 36px; height: 36px; border-radius: 50%; padding: 0; display: flex; align-items: center; justify-content: center; margin-bottom: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"
                                            onclick="event.preventDefault(); event.stopPropagation(); toggleLikeQuick(@recipe.Id, this);">
                                        <i class="ti-heart" style="font-size: 16px;"></i>
                                    </button>
                                    <button type="button" class="btn btn-sm btn-light recipe-quick-save" data-recipe-id="@recipe.Id"
                                            style="width: 36px; height: 36px; border-radius: 50%; padding: 0; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"
                                            onclick="event.preventDefault(); event.stopPropagation(); toggleSaveQuick(@recipe.Id, this);">
                                        <i class="ti-bookmark" style="font-size: 16px;"></i>
                                    </button>
                                }
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        }
    }
</div>

<style>
    /* Recipe Card Container */
    .recipe-card-container {
        position: relative;
    }
    
    /* Recipe Card Hover Effects */
    .recipe-card-link {
        text-decoration: none !important;
    }
    
    .recipe-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    
    .recipe-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 12px 24px rgba(0,0,0,0.15) !important;
    }
    
    .recipe-card:hover .recipe-card-image-wrapper img {
        transform: scale(1.1);
    }
    
    .recipe-card:hover .recipe-card-overlay {
        opacity: 1 !important;
    }
    
    .recipe-card:hover .recipe-quick-actions {
        opacity: 1 !important;
    }
    
    .recipe-card:hover h6 {
        color: #007bff !important;
    }
    
    /* Badge Animations */
    .recipe-badges .badge {
        animation: fadeInUp 0.3s ease;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    @@keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Category Badge Colors */
    .category-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
        font-weight: 500;
        display: inline-block;
    }
    
    .category-badge[data-category-id="1"] { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .category-badge[data-category-id="2"] { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .category-badge[data-category-id="3"] { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    .category-badge[data-category-id="4"] { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
    .category-badge[data-category-id="5"] { background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); }
    .category-badge[data-category-id="6"] { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
    
    /* Quick Actions */
    .recipe-quick-actions button {
        transition: all 0.2s ease;
    }
    
    .recipe-quick-actions button:hover {
        transform: scale(1.1);
        background-color: #fff !important;
    }
    
    .recipe-quick-actions .recipe-quick-like.active i {
        color: #dc3545;
    }
    
    .recipe-quick-actions .recipe-quick-save.active i {
        color: #ffc107;
    }
    
    /* Personalization Tags */
    .recipe-personal-tag {
        position: absolute;
        bottom: 10px;
        right: 10px;
        background: rgba(0, 123, 255, 0.9);
        color: white;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 10px;
        font-weight: 600;
        z-index: 5;
        animation: pulse 2s infinite;
    }
    
    @@keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }
    
    /* Search Type Dropdown */
    .search-type-dropdown {
        position: relative;
    }
    
    .search-type-btn:hover {
        color: #007bff !important;
    }
    
    .search-type-option:hover {
        background-color: #f8f9fa;
        color: #007bff !important;
    }
    
    .search-type-option.active {
        background-color: #e7f3ff;
        color: #007bff !important;
        font-weight: 600;
    }
</style>

@section Scripts {
    <script>
        // Search type dropdown functionality
        const searchTypeBtn = document.getElementById('searchTypeBtn');
        const searchTypeMenu = document.getElementById('searchTypeMenu');
        const searchTypeOptions = document.querySelectorAll('.search-type-option');
        const searchTypeInput = document.getElementById('searchType');
        const searchTypeText = document.getElementById('searchTypeText');
        const searchForm = document.getElementById('searchForm');

        // Toggle dropdown
        if (searchTypeBtn) {
            searchTypeBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                searchTypeMenu.style.display = searchTypeMenu.style.display === 'none' ? 'block' : 'none';
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!searchTypeBtn.contains(e.target) && !searchTypeMenu.contains(e.target)) {
                    searchTypeMenu.style.display = 'none';
                }
            });

            // Handle option selection
            searchTypeOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.preventDefault();
                    const type = this.getAttribute('data-type');
                    const text = this.textContent.trim();
                    
                    searchTypeInput.value = type;
                    searchTypeText.textContent = text;
                    
                    // Update active state
                    searchTypeOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    
                    searchTypeMenu.style.display = 'none';
                });
            });

            // Set initial active state
            const currentType = searchTypeInput.value || 'all';
            searchTypeOptions.forEach(option => {
                if (option.getAttribute('data-type') === currentType) {
                    option.classList.add('active');
                    searchTypeText.textContent = option.textContent.trim();
                }
            });
        }

        // Submit form on Enter key
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    searchForm.submit();
                }
            });
        }

        // Sort dropdown functionality
        const sortDropdownBtn = document.getElementById('sortDropdownBtn');
        const sortDropdownMenu = document.getElementById('sortDropdownMenu');

        if (sortDropdownBtn && sortDropdownMenu) {
            sortDropdownBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                sortDropdownMenu.style.display = sortDropdownMenu.style.display === 'none' ? 'block' : 'none';
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!sortDropdownBtn.contains(e.target) && !sortDropdownMenu.contains(e.target)) {
                    sortDropdownMenu.style.display = 'none';
                }
            });
        }
    </script>
}
